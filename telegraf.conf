# ============================================
# TELEGRAF CONFIGURACIÓN - POZO PILOTO
# ============================================

[agent]
  interval = "1s"
  flush_interval = "1s"
  omit_hostname = true

# ============================================
# SALIDA A INFLUXDB CLOUD
# ============================================

[[outputs.influxdb_v2]]
  urls = ["https://us-east-1-1.aws.cloud2.influxdata.com"]
  token = "$INFLUX_TOKEN"          # Render lo inyectará como variable de entorno
  organization = "PilotoPumpOff"
  bucket = "PozoPiloto"

# ============================================
# ENTRADA DESDE BROKER MQTT (EMQX)
# ============================================

[[inputs.mqtt_consumer]]
  servers = ["tcp://broker.emqx.io:1883"]
  topics = ["gtg/pozopiloto/datos"]
  client_id = "telegraf-pozopiloto"
  qos = 0
  data_format = "grok"
  grok_patterns = ['%{NUMBER:id:int};%{NUMBER:aceleracion:float};%{NUMBER:carga:float}\\$']
  name_override = "pozo_datos"
